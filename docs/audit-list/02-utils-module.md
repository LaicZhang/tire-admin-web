# Utils 工具模块审计报告

> 审计时间: 2025-12-25 (最终更新)
> 模块路径: `src/utils/`

---

## 模块概览

| 统计项   | 数量                                     |
| -------- | ---------------------------------------- |
| 工具文件 | 17                                       |
| 子目录   | 3 (`http/`, `localforage/`, `progress/`) |

**核心文件**:

- `auth.ts` - Token 和用户认证管理
- `http/index.ts` - HTTP 请求封装
- `tree.ts` - 树形结构操作
- `message.ts` - 消息提示封装
- `security.ts` - 安全相关工具

---

## ✅ 已修复问题

### ~~1. 消息工具函数冗余代码~~ ✅ 已修复

**修复内容**: `message.ts` 中注释掉的代码和未使用的参数已清理。

---

## 🟡 中等问题 (中优先级)

### 2. HTTP 请求类型定义不完整

**问题描述**: `http/types.d.ts` 使用默认导出 class，不利于 tree-shaking。

**建议**: 改用命名导出 `export class PureHttp { ... }`

---

### 3. 缺少单元测试

**问题描述**: 工具函数缺少单元测试覆盖。

**影响**:

- `tree.ts` 的递归函数容易出错
- `auth.ts` 的 token 处理逻辑复杂

---

## 🟢 轻微问题 (低优先级)

### 4. 递归调用可能栈溢出

**问题描述**: `tree.ts` 中的递归函数对深层嵌套数据可能导致栈溢出。

**建议**: 考虑使用迭代方式或设置最大深度限制。

---

### 5. 文件组织可优化

**建议**: 按功能分组文件到子目录。
